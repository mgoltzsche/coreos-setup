#!/bin/sh

[ $# -eq 1 ] && [ "$1" ] || (echo "Usage: $0 CONSULHOST" >&2; false) || exit 1

for SEC in 1 1 1 1 1 1 1 1 1 1; do
	curl -XGET "http://$1:8500/v1/kv/?keys" >/dev/null 2>/dev/null && exit 0
	sleep 1
done
echo "consul ($1) unavailable" >&2
exit 1
